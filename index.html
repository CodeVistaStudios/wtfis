<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WTF is Fun? | Dad Jokes</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.css">
    <style>
        .gradient-bg {
            background: linear-gradient(180deg, #EBF4FF 0%, #F3E8FF 100%);
        }
        .btn {
            transition: all 0.3s ease;
        }
        .btn:hover {
            transform: translateY(-2px);
        }
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        .loading {
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="gradient-bg min-h-screen">
    <div class="container mx-auto px-4 py-8 min-h-screen flex flex-col items-center justify-center">
        <div class="max-w-2xl w-full space-y-8">
            <!-- Header Section -->
            <div class="text-center space-y-4">
                <h1 class="text-4xl font-bold text-blue-800">WTF is Fun?</h1>
                <p class="text-xl text-gray-600">Dad jokes that make you go WTF ü§¶‚Äç‚ôÇÔ∏è</p>
            </div>

            <!-- Main Card -->
            <div class="bg-white rounded-lg shadow-xl p-6 space-y-6">
                <!-- Joke Display -->
                <div id="jokeContainer" class="min-h-[100px] flex items-center justify-center">
                    <p id="jokeText" class="text-2xl text-center font-medium text-gray-700 fade-in"></p>
                    <svg id="loadingSpinner" class="loading h-8 w-8 text-blue-500 hidden" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" fill="none"></circle>
                        <path class="opacity-75" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                    </svg>
                </div>

                <!-- Error Alert -->
                <div id="errorAlert" class="hidden bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative" role="alert">
                    <span id="errorText" class="block sm:inline"></span>
                </div>

                <!-- Interaction Buttons -->
                <div class="flex justify-center space-x-4">
                    <button id="likeBtn" class="btn flex items-center space-x-2 px-4 py-2 border rounded-md hover:bg-gray-50">
                        <span>üëç</span>
                        <span id="likeCount">0</span>
                    </button>
                    <button id="dislikeBtn" class="btn flex items-center space-x-2 px-4 py-2 border rounded-md hover:bg-gray-50">
                        <span>üëé</span>
                        <span id="dislikeCount">0</span>
                    </button>
                </div>

                <!-- Action Buttons -->
                <div class="flex justify-center space-x-4 pt-4">
                    <button id="newJokeBtn" class="btn bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded">
                        New Joke
                    </button>
                    <button id="copyBtn" class="btn bg-white border border-gray-300 hover:bg-gray-50 text-gray-700 font-bold py-2 px-4 rounded flex items-center">
                        <span>üìã</span>
                        <span class="ml-2">Copy</span>
                    </button>
                    <button id="shareBtn" class="btn bg-white border border-gray-300 hover:bg-gray-50 text-gray-700 font-bold py-2 px-4 rounded flex items-center">
                        <span>üì§</span>
                        <span class="ml-2">Share</span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        const jokeText = document.getElementById('jokeText');
        const loadingSpinner = document.getElementById('loadingSpinner');
        const errorAlert = document.getElementById('errorAlert');
        const errorText = document.getElementById('errorText');
        const likeCount = document.getElementById('likeCount');
        const dislikeCount = document.getElementById('dislikeCount');
        const newJokeBtn = document.getElementById('newJokeBtn');
        const copyBtn = document.getElementById('copyBtn');
        const shareBtn = document.getElementById('shareBtn');

        let currentJoke = '';

        async function fetchJoke() {
            jokeText.classList.remove('fade-in');
            jokeText.textContent = '';
            loadingSpinner.classList.remove('hidden');
            errorAlert.classList.add('hidden');

            try {
                const response = await fetch('https://icanhazdadjoke.com/', {
                    headers: {
                        'Accept': 'application/json'
                    }
                });

                if (!response.ok) throw new Error('Failed to fetch joke');

                const data = await response.json();
                currentJoke = data.joke;
                
                loadingSpinner.classList.add('hidden');
                jokeText.textContent = currentJoke;
                jokeText.classList.add('fade-in');
            } catch (err) {
                loadingSpinner.classList.add('hidden');
                errorText.textContent = "Oops! Dad went to get milk... (API Error)";
                errorAlert.classList.remove('hidden');
            }
        }

        async function copyToClipboard() {
            try {
                await navigator.clipboard.writeText(currentJoke);
                const originalText = copyBtn.innerHTML;
                copyBtn.innerHTML = '<span>‚úÖ</span><span class="ml-2">Copied!</span>';
                setTimeout(() => {
                    copyBtn.innerHTML = originalText;
                }, 2000);
            } catch (err) {
                errorText.textContent = "Failed to copy joke";
                errorAlert.classList.remove('hidden');
            }
        }

        async function shareJoke() {
            try {
                await navigator.share({
                    title: 'Check out this dad joke!',
                    text: currentJoke,
                    url: 'https://wtfis.fun'
                });
            } catch (err) {
                if (err.name !== 'AbortError') {
                    errorText.textContent = "Sharing not supported on this device";
                    errorAlert.classList.remove('hidden');
                }
            }
        }

        // Event Listeners
        newJokeBtn.addEventListener('click', fetchJoke);
        copyBtn.addEventListener('click', copyToClipboard);
        shareBtn.addEventListener('click', shareJoke);
        document.getElementById('likeBtn').addEventListener('click', () => {
            likeCount.textContent = parseInt(likeCount.textContent) + 1;
        });
        document.getElementById('dislikeBtn').addEventListener('click', () => {
            dislikeCount.textContent = parseInt(dislikeCount.textContent) + 1;
        });

        // Initial joke fetch
        fetchJoke();
    </script>
</body>
</html>
